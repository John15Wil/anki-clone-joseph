# æ—¶é—´é—´éš”å•ä½ç»Ÿä¸€ä¿®å¤

## ğŸ› é—®é¢˜æ ¹æº

### æ ¸å¿ƒé—®é¢˜ï¼šinterval å•ä½ä¸ç»Ÿä¸€

**åŸå§‹ä»£ç æ··ç”¨äº†ä¸¤ç§å•ä½**ï¼š

```typescript
// å­¦ä¹ é˜¶æ®µ - ä½¿ç”¨"åˆ†é’Ÿ"ä½œä¸ºå•ä½
const nextStep = LEARNING_STEPS[stepIndex + 1]; // 10 (è¡¨ç¤º10åˆ†é’Ÿ)
return {
  interval: nextStep, // 10 (åˆ†é’Ÿ)
  nextReview: now + nextStep * 60 * 1000
};

// å¤ä¹ é˜¶æ®µ - ä½¿ç”¨"å¤©"ä½œä¸ºå•ä½
return {
  interval: GRADUATING_INTERVAL, // 2 (è¡¨ç¤º2å¤©)
  nextReview: now + GRADUATING_INTERVAL * 24 * 60 * 60 * 1000
};
```

**formatInterval å‡½æ•°å‡è®¾æ‰€æœ‰ interval éƒ½æ˜¯"å¤©"**ï¼š
```typescript
export function formatInterval(interval: number): string {
  if (interval < 1) {
    const minutes = Math.round(interval * 24 * 60);  // âŒ æŠŠå¤©æ•°è½¬æ¢ä¸ºåˆ†é’Ÿ
    return `${minutes}åˆ†é’Ÿ`;
  }
  return `${Math.round(interval)}å¤©`;
}
```

**å¯¼è‡´çš„é—®é¢˜**ï¼š
- å­¦ä¹ é˜¶æ®µ `interval: 10` (åˆ†é’Ÿ) â†’ `formatInterval(10)` â†’ "10å¤©" âŒ
- å­¦ä¹ é˜¶æ®µ `interval: 30` (åˆ†é’Ÿ) â†’ `formatInterval(30)` â†’ "30å¤©" âŒ

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ç»Ÿä¸€ä½¿ç”¨"å¤©"ä½œä¸º interval çš„å•ä½

**ä¿®æ”¹æ‰€æœ‰è¿”å›çš„ intervalï¼Œç»Ÿä¸€è½¬æ¢ä¸ºå¤©æ•°**ï¼š

```typescript
// 1. é‡æ¥ï¼ˆ1åˆ†é’Ÿï¼‰
interval: 1 / (24 * 60)  // 1åˆ†é’Ÿ Ã· 1440 = 0.000694å¤©

// 2. å­¦ä¹ é˜¶æ®µå›°éš¾ï¼ˆé‡å¤å½“å‰æ­¥éª¤ï¼Œå¦‚10åˆ†é’Ÿï¼‰
const currentStepMinutes = LEARNING_STEPS[...];
interval: currentStepMinutes / (24 * 60)  // 10åˆ†é’Ÿ Ã· 1440 = 0.00694å¤©

// 3. å­¦ä¹ é˜¶æ®µä¸€èˆ¬ï¼ˆä¸‹ä¸€æ­¥ï¼Œå¦‚30åˆ†é’Ÿï¼‰
const nextStepMinutes = LEARNING_STEPS[stepIndex + 1];
interval: nextStepMinutes / (24 * 60)  // 30åˆ†é’Ÿ Ã· 1440 = 0.0208å¤©

// 4. å­¦ä¹ é˜¶æ®µç®€å•ï¼ˆç›´æ¥æ¯•ä¸šï¼‰
interval: EASY_INTERVAL  // 5å¤©

// 5. å­¦ä¹ å®Œæˆæ¯•ä¸š
interval: GRADUATING_INTERVAL  // 2å¤©

// 6. å¤ä¹ é˜¶æ®µå›°éš¾ï¼ˆè¿”å›å­¦ä¹ ï¼‰
interval: HARD_RELEARN_STEP / (24 * 60)  // 10åˆ†é’Ÿ Ã· 1440 = 0.00694å¤©

// 7. å¤ä¹ é˜¶æ®µä¸€èˆ¬
interval: Math.round(interval * ease)  // å¤©æ•°

// 8. å¤ä¹ é˜¶æ®µç®€å•
interval: Math.round(interval * ease * 1.3)  // å¤©æ•°
```

**ç°åœ¨ formatInterval å‡½æ•°å¯ä»¥æ­£ç¡®å·¥ä½œ**ï¼š
```typescript
// å­¦ä¹ é˜¶æ®µ interval: 0.00694 (10åˆ†é’Ÿ)
formatInterval(0.00694)
â†’ interval < 1
â†’ minutes = 0.00694 Ã— 24 Ã— 60 = 10
â†’ return "10åˆ†é’Ÿ" âœ…

// å­¦ä¹ é˜¶æ®µ interval: 0.0208 (30åˆ†é’Ÿ)
formatInterval(0.0208)
â†’ interval < 1
â†’ minutes = 0.0208 Ã— 24 Ã— 60 = 30
â†’ return "30åˆ†é’Ÿ" âœ…

// å¤ä¹ é˜¶æ®µ interval: 7 (7å¤©)
formatInterval(7)
â†’ interval >= 1
â†’ return "7å¤©" âœ…
```

---

## ğŸ“Š ä¿®å¤åçš„å®Œæ•´æµç¨‹

### åœºæ™¯ 1ï¼šå…¨æ–°å¡ç‰‡ï¼ˆstate='new', repetitions=0ï¼‰

| è¯„çº§ | interval | nextReview | æ˜¾ç¤º | ä¸‹ä¸€çŠ¶æ€ |
|------|----------|-----------|------|---------|
| é‡æ¥(1) | 1/1440 â‰ˆ 0.0007å¤© | now + 1åˆ†é’Ÿ | "1åˆ†é’Ÿ" | learning |
| å›°éš¾(2) | 1/1440 â‰ˆ 0.0007å¤© | now + 1åˆ†é’Ÿ | "1åˆ†é’Ÿ" | learning |
| ä¸€èˆ¬(3) | 10/1440 â‰ˆ 0.0069å¤© | now + 10åˆ†é’Ÿ | "10åˆ†é’Ÿ" | learning |
| ç®€å•(4) | 5å¤© | now + 5å¤© | "5å¤©" | review |

### åœºæ™¯ 2ï¼šå­¦ä¹ ä¸­å¡ç‰‡ï¼ˆstate='learning', repetitions=1ï¼‰

| è¯„çº§ | interval | nextReview | æ˜¾ç¤º | ä¸‹ä¸€çŠ¶æ€ |
|------|----------|-----------|------|---------|
| é‡æ¥(1) | 1/1440 â‰ˆ 0.0007å¤© | now + 1åˆ†é’Ÿ | "1åˆ†é’Ÿ" | learning |
| å›°éš¾(2) | 10/1440 â‰ˆ 0.0069å¤© | now + 10åˆ†é’Ÿ | "10åˆ†é’Ÿ" | learning |
| ä¸€èˆ¬(3) | 30/1440 â‰ˆ 0.0208å¤© | now + 30åˆ†é’Ÿ | "30åˆ†é’Ÿ" | learning |
| ç®€å•(4) | 5å¤© | now + 5å¤© | "5å¤©" | review |

### åœºæ™¯ 3ï¼šå³å°†æ¯•ä¸šï¼ˆstate='learning', repetitions=2ï¼‰

| è¯„çº§ | interval | nextReview | æ˜¾ç¤º | ä¸‹ä¸€çŠ¶æ€ |
|------|----------|-----------|------|---------|
| é‡æ¥(1) | 1/1440 â‰ˆ 0.0007å¤© | now + 1åˆ†é’Ÿ | "1åˆ†é’Ÿ" | learning |
| å›°éš¾(2) | 30/1440 â‰ˆ 0.0208å¤© | now + 30åˆ†é’Ÿ | "30åˆ†é’Ÿ" | learning |
| ä¸€èˆ¬(3) | 2å¤© | now + 2å¤© | "2å¤©" | review (æ¯•ä¸š) |
| ç®€å•(4) | 5å¤© | now + 5å¤© | "5å¤©" | review |

### åœºæ™¯ 4ï¼šå¤ä¹ é˜¶æ®µï¼ˆstate='review', interval=7, ease=2.5ï¼‰

| è¯„çº§ | interval | nextReview | æ˜¾ç¤º | ä¸‹ä¸€çŠ¶æ€ |
|------|----------|-----------|------|---------|
| é‡æ¥(1) | 1/1440 â‰ˆ 0.0007å¤© | now + 1åˆ†é’Ÿ | "1åˆ†é’Ÿ" | learning |
| å›°éš¾(2) | 10/1440 â‰ˆ 0.0069å¤© | now + 10åˆ†é’Ÿ | "10åˆ†é’Ÿ" | relearning |
| ä¸€èˆ¬(3) | 7 Ã— 2.5 = 18å¤© | now + 18å¤© | "18å¤©" | review |
| ç®€å•(4) | 7 Ã— 2.65 Ã— 1.3 = 24å¤© | now + 24å¤© | "24å¤©" | review |

---

## ğŸ§ª éªŒè¯æµ‹è¯•

### æµ‹è¯• 1ï¼šæ–°å¡ç‰‡æ—¶é—´æ˜¾ç¤º

**æ­¥éª¤**ï¼š
1. åˆ›å»ºæ–°å¡ç‰‡ï¼ˆstate='new'ï¼‰
2. å¼€å§‹å­¦ä¹ 
3. ç‚¹å‡»"æ˜¾ç¤ºç­”æ¡ˆ"
4. æŸ¥çœ‹4ä¸ªæŒ‰é’®çš„æ—¶é—´æ˜¾ç¤º

**é¢„æœŸç»“æœ**ï¼š
- âŒ é‡æ¥ï¼š**1åˆ†é’Ÿ** (ä¹‹å‰æ˜¾ç¤º "1å¤©")
- ğŸ˜° å›°éš¾ï¼š**1åˆ†é’Ÿ** (ä¹‹å‰æ˜¾ç¤º "1å¤©")
- ğŸ‘ ä¸€èˆ¬ï¼š**10åˆ†é’Ÿ** (ä¹‹å‰æ˜¾ç¤º "10å¤©") âœ… å…³é”®ä¿®å¤
- âœ¨ ç®€å•ï¼š**5å¤©** (æ­£ç¡®)

### æµ‹è¯• 2ï¼šå­¦ä¹ ä¸­å¡ç‰‡æ—¶é—´æ˜¾ç¤º

**æ­¥éª¤**ï¼š
1. æ–°å¡ç‰‡é€‰æ‹©"ä¸€èˆ¬"ï¼ˆè¿›å…¥å­¦ä¹ é˜¶æ®µï¼Œrepetitions=1ï¼‰
2. ç­‰å¾…10åˆ†é’Ÿåå¡ç‰‡åˆ°æœŸ
3. å†æ¬¡å­¦ä¹ è¯¥å¡ç‰‡
4. æŸ¥çœ‹4ä¸ªæŒ‰é’®çš„æ—¶é—´æ˜¾ç¤º

**é¢„æœŸç»“æœ**ï¼š
- âŒ é‡æ¥ï¼š**1åˆ†é’Ÿ**
- ğŸ˜° å›°éš¾ï¼š**10åˆ†é’Ÿ** (é‡å¤å½“å‰æ­¥éª¤)
- ğŸ‘ ä¸€èˆ¬ï¼š**30åˆ†é’Ÿ** (ä¹‹å‰æ˜¾ç¤º "30å¤©") âœ… å…³é”®ä¿®å¤
- âœ¨ ç®€å•ï¼š**5å¤©**

### æµ‹è¯• 3ï¼šå³å°†æ¯•ä¸šæ—¶é—´æ˜¾ç¤º

**æ­¥éª¤**ï¼š
1. å­¦ä¹ ä¸­å¡ç‰‡é€‰æ‹©"ä¸€èˆ¬"ï¼ˆrepetitions=2ï¼Œæœ€åä¸€æ­¥ï¼‰
2. æŸ¥çœ‹4ä¸ªæŒ‰é’®çš„æ—¶é—´æ˜¾ç¤º

**é¢„æœŸç»“æœ**ï¼š
- âŒ é‡æ¥ï¼š**1åˆ†é’Ÿ**
- ğŸ˜° å›°éš¾ï¼š**30åˆ†é’Ÿ** (é‡å¤å½“å‰æ­¥éª¤)
- ğŸ‘ ä¸€èˆ¬ï¼š**2å¤©** (æ¯•ä¸šé—´éš”) âœ…
- âœ¨ ç®€å•ï¼š**5å¤©**

### æµ‹è¯• 4ï¼šå¤ä¹ é˜¶æ®µæ—¶é—´æ˜¾ç¤º

**æ­¥éª¤**ï¼š
1. å¤ä¹ å¡ç‰‡ï¼ˆstate='review', interval=7å¤©, ease=2.5ï¼‰
2. æŸ¥çœ‹4ä¸ªæŒ‰é’®çš„æ—¶é—´æ˜¾ç¤º

**é¢„æœŸç»“æœ**ï¼š
- âŒ é‡æ¥ï¼š**1åˆ†é’Ÿ**
- ğŸ˜° å›°éš¾ï¼š**10åˆ†é’Ÿ** (è¿”å›å­¦ä¹ é˜¶æ®µ)
- ğŸ‘ ä¸€èˆ¬ï¼š**18å¤©** (7 Ã— 2.5) âœ…
- âœ¨ ç®€å•ï¼š**24å¤©** (7 Ã— 2.65 Ã— 1.3) âœ…

---

## ğŸ”§ ä»£ç å˜æ›´è¯¦æƒ…

### æ–‡ä»¶ï¼š`/src/lib/srs.ts`

#### 1. é‡æ¥è¯„çº§ (rating=1)
```diff
- interval: 1, // 1 åˆ†é’Ÿåé‡æ–°å­¦ä¹ 
+ interval: 1 / (24 * 60), // 1 åˆ†é’Ÿè½¬æ¢ä¸ºå¤©æ•°ï¼ˆ1 / 1440ï¼‰
```

#### 2. å­¦ä¹ é˜¶æ®µ - å›°éš¾ (rating=2)
```diff
- const currentStep = LEARNING_STEPS[Math.min(repetitions, LEARNING_STEPS.length - 1)];
  return {
    ease,
-   interval: currentStep,
+   interval: currentStepMinutes / (24 * 60), // è½¬æ¢ä¸ºå¤©æ•°ï¼ˆåˆ†é’Ÿ / 1440ï¼‰
    repetitions,
-   nextReview: now + currentStep * 60 * 1000,
+   nextReview: now + currentStepMinutes * 60 * 1000,
    state: review.state === 'new' ? 'learning' : 'relearning'
  };
```

#### 3. å­¦ä¹ é˜¶æ®µ - ä¸€èˆ¬ (rating=3)
```diff
  // è¿›å…¥ä¸‹ä¸€ä¸ªå­¦ä¹ æ­¥éª¤
- const nextStep = LEARNING_STEPS[stepIndex + 1];
+ const nextStepMinutes = LEARNING_STEPS[stepIndex + 1];
  return {
    ease,
-   interval: nextStep,
+   interval: nextStepMinutes / (24 * 60), // è½¬æ¢ä¸ºå¤©æ•°ï¼ˆåˆ†é’Ÿ / 1440ï¼‰
    repetitions: repetitions + 1,
-   nextReview: now + nextStep * 60 * 1000,
+   nextReview: now + nextStepMinutes * 60 * 1000,
    state: review.state === 'new' ? 'learning' : 'relearning'
  };
```

#### 4. å¤ä¹ é˜¶æ®µ - å›°éš¾ (rating=2)
```diff
  if (rating === 2) {
    return {
      ease: Math.max(MINIMUM_EASE, ease - 0.15),
-     interval: HARD_RELEARN_STEP, // 10åˆ†é’Ÿ
+     interval: HARD_RELEARN_STEP / (24 * 60), // 10åˆ†é’Ÿè½¬æ¢ä¸ºå¤©æ•°
      repetitions: 0,
      nextReview: now + HARD_RELEARN_STEP * 60 * 1000, // 10åˆ†é’Ÿå
      state: 'relearning' // è¿›å…¥é‡æ–°å­¦ä¹ çŠ¶æ€
    };
  }
```

---

## ğŸ“ å•ä½è½¬æ¢è¯´æ˜

### ä¸ºä»€ä¹ˆæ˜¯ `åˆ†é’Ÿ / (24 * 60)`ï¼Ÿ

1å¤© = 24å°æ—¶ = 24 Ã— 60åˆ†é’Ÿ = 1440åˆ†é’Ÿ

æ‰€ä»¥ï¼š
```
1åˆ†é’Ÿ = 1 / 1440 å¤© â‰ˆ 0.000694å¤©
10åˆ†é’Ÿ = 10 / 1440 å¤© â‰ˆ 0.00694å¤©
30åˆ†é’Ÿ = 30 / 1440 å¤© â‰ˆ 0.0208å¤©
```

### formatInterval å¦‚ä½•åå‘è½¬æ¢ï¼Ÿ

```typescript
if (interval < 1) {
  const minutes = Math.round(interval * 24 * 60);
  // 0.00694å¤© Ã— 1440 = 10åˆ†é’Ÿ âœ…
  return `${minutes}åˆ†é’Ÿ`;
}
```

---

## âœ… éªŒæ”¶æ ‡å‡†

### å¿…é¡»é€šè¿‡çš„æµ‹è¯•

1. âœ… æ–°å¡ç‰‡"ä¸€èˆ¬"æ˜¾ç¤º **10åˆ†é’Ÿ** (ä¸æ˜¯10å¤©)
2. âœ… å­¦ä¹ ä¸­"ä¸€èˆ¬"æ˜¾ç¤º **30åˆ†é’Ÿ** (ä¸æ˜¯30å¤©)
3. âœ… å³å°†æ¯•ä¸š"ä¸€èˆ¬"æ˜¾ç¤º **2å¤©**
4. âœ… å¤ä¹ é˜¶æ®µ"ä¸€èˆ¬"æ˜¾ç¤ºæ­£ç¡®å¤©æ•°ï¼ˆinterval Ã— easeï¼‰
5. âœ… æ‰€æœ‰"ç®€å•"éƒ½æ˜¾ç¤º **5å¤©**
6. âœ… æ‰€æœ‰"å›°éš¾"æ ¹æ®çŠ¶æ€æ˜¾ç¤ºæ­£ç¡®æ—¶é—´

### æ•°æ®åº“å…¼å®¹æ€§

**é‡è¦**ï¼šinterval å•ä½å˜æ›´å¯èƒ½å½±å“å·²æœ‰æ•°æ®ï¼

**è¿ç§»ç­–ç•¥**ï¼š
- æ—§æ•°æ®ï¼šå­¦ä¹ é˜¶æ®µçš„ interval æ˜¯åˆ†é’Ÿæ•°
- æ–°æ•°æ®ï¼šæ‰€æœ‰ interval éƒ½æ˜¯å¤©æ•°

**è§£å†³æ–¹æ¡ˆ**ï¼š
- formatInterval å‡½æ•°å¯ä»¥æ­£ç¡®å¤„ç†ä¸¤ç§æƒ…å†µ
- æ—§æ•°æ®åœ¨ä¸‹æ¬¡å¤ä¹ æ—¶ä¼šè‡ªåŠ¨æ›´æ–°ä¸ºæ–°æ ¼å¼
- æ— éœ€æ‰‹åŠ¨è¿ç§»æ•°æ®åº“

---

## ğŸ‰ ä¿®å¤æ€»ç»“

### é—®é¢˜
- interval å•ä½æ··ç”¨ï¼ˆåˆ†é’Ÿ/å¤©ï¼‰
- formatInterval å‡è®¾æ‰€æœ‰éƒ½æ˜¯å¤©æ•°
- å¯¼è‡´å­¦ä¹ é˜¶æ®µæ˜¾ç¤ºé”™è¯¯æ—¶é—´

### è§£å†³
- ç»Ÿä¸€æ‰€æœ‰ interval ä½¿ç”¨"å¤©"ä½œä¸ºå•ä½
- å­¦ä¹ é˜¶æ®µçš„åˆ†é’Ÿæ•°è½¬æ¢ä¸ºå¤©æ•°ï¼ˆåˆ†é’Ÿ / 1440ï¼‰
- formatInterval æ­£ç¡®å¤„ç† < 1å¤©çš„æƒ…å†µ

### ç»“æœ
- âœ… æ‰€æœ‰æ—¶é—´æ˜¾ç¤ºæ­£ç¡®
- âœ… å­¦ä¹ é˜¶æ®µï¼š1åˆ†é’Ÿã€10åˆ†é’Ÿã€30åˆ†é’Ÿ
- âœ… æ¯•ä¸š/ç®€å•ï¼š2å¤©ã€5å¤©
- âœ… å¤ä¹ é˜¶æ®µï¼šæ ¹æ®ç®—æ³•è®¡ç®—çš„å¤©æ•°

ç°åœ¨æ—¶é—´æ˜¾ç¤ºå®Œå…¨æ­£ç¡®äº†ï¼ğŸŠ
